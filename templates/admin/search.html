  {% extends "dash_layout.html" %}

  <title>
      {% block title %}
      ðŸš— Park-Karo! - ADMIN
      {% endblock %}
  </title>

{% block styles %}
<style>
  body {
    background-color: #ebebeb;
  }
  .card {
    border-radius: 1.2rem !important;
  }
  .card.shadow {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  .btn-warning {
    background-color: #ffc800;
    border: none;
  }
  .btn-warning:hover {
    background-color: #e6b800;
  }
  .spot-box {
    border-radius: 0.5rem;
  }
</style>
{% endblock %}

  {% block content %}
  <div class="container mt-4">
    <div class="card shadow rounded p-4">
      <h1 class="mb-3 fw-normal text-center">Search</h1>
    <form method="GET" action="{{ url_for('auth.admin_search') }}" class="row g-3">
      <div class="col-md-3">
        <select name="filter_by" class="form-select" required>
          <option value="">Search by...</option>
          <option value="spot_id" {% if request.args.get('filter_by') == 'spot_id' %}selected{% endif %}>Spot ID</option>
          <option value="user_id" {% if request.args.get('filter_by') == 'user_id' %}selected{% endif %}>User ID</option>
          <option value="location" {% if request.args.get('filter_by') == 'location' %}selected{% endif %}>Location</option>
        </select>
      </div>
      <div class="col-md-6 mb-3">
        <input type="text" name="query" placeholder="Enter search term" class="form-control" required value="{{ request.args.get('query', '') }}">
      </div>
      <div class="col-md-3">
        <button class="btn btn-warning w-100 fw-bold" type="submit">Search</button>
      </div>
    </form>
    {% if results %}
    <h5 class="mb-3 text-center text-muted">Search Results:</h5>
    <div class="table-responsive">
      <table class="table table-striped table-bordered table-hover align-middle ">
         <thead class="thead-light text-center">
          <tr>
            <th>Type</th>
            <th>ID</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody>
          {% for r in results %}
          <tr class="text-center">
            <td>{{ r.type }}</td>
            <td>{{ r.id }}</td>
            <td>
              {% if r.type == 'Spot' %}
                <b>Lot ID:</b> {{ r.lot_id }}<br>
                <b>Status:</b> <span class="fw-bold {{ 'text-danger' if r.status == 'Occupied' else 'text-success' }}">{{ r.status }}</span>
              {% elif r.type == 'User' %}
                <b>Name:</b> {{ r.name }}<br>
                <b>Email:</b> {{ r.email }}
              {% elif r.type == 'Lot' %}
                <b>Name:</b> {{ r.name }}<br>
                <b>Address:</b> {{ r.address }}<br>
                {% if r.available is defined %}
                <p><strong>Available Spots:</strong> {{ r.available }}</p>
              {% elif r.status == 'inactive' %}
                <p class="text-danger fw-bold">Lot was deleted</p>
              {% endif %}
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% elif request.args.get('query') %}
      <p class="text-center text-muted">No matching results found.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
