{% extends "dash_layout.html" %}

<title>
  {% block title %}
  ðŸš— Park-Karo! - Reservations
  {% endblock %}
</title>

{% block styles %}
<style>
  body {
    background-color: #ebebeb;
  }
  .card {
    border-radius: 1.2rem !important;
  }
  .card.shadow {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  .btn-release {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
    padding: 4px 10px;
    border-radius: 5px;
    font-weight: 600;
  }
  .btn-out {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
    padding: 4px 10px;
    border-radius: 5px;
    font-weight: 600;
  }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow rounded p-4">
    <h1 class="mb-4 fw-normal text-center">Reservation History - {{ user.name }}</h1>

    {% if reservations %}
    <div class="table-responsive">
      <table class="table table-bordered table-hover">
        <thead class="table-light text-center">
          <tr>
            <th>Location</th>
            <th>Vehicle No</th>
            <th>Start Timestamp</th>
            <th>End Timestamp</th>
            <th>Cost</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody class="text-center">
          {% for r in reservations %}
          <tr>
            <td>{{ r.location }}, {{r.address}}, {{r.pincode}}</td>
            <td>{{ r.vehicle_number }}</td>
            <td>{{ r.start_time.strftime('%d-%m-%Y %H:%M') }}</td>
            <td>
              {% if r.end_time %}
                {{ r.end_time.strftime('%d-%m-%Y %H:%M') }}
              {% else %}
                  â€”
              {% endif %}
            </td>
            <td>
              {% if r.end_time %}
                  ${{ ( (r.end_time - r.start_time).total_seconds() / 3600 * r.cost_per_hour ) | round(2) }}
              {% else %}
                  â€”
              {% endif %}
            </td>
            <td>
              {% if not r.end_time %}
                <span class="text-danger">Parked</span>
            {% else %}
                <span class="text-success">Vacated</span>
            {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
      <p class="text-center text-muted">This user has not made any reservations yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
